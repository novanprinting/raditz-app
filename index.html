<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RADITZ OJOL PRO</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg: #f8fafc;
            --card: #ffffff;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--bg);
            padding-bottom: 80px;
        }

        .header {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .container { padding: 15px; max-width: 500px; margin: auto; }

        .page { display: none; }
        .page.active { display: block; }

        .card {
            background: var(--card);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }

        input, button {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        .btn-primary { background: var(--primary); color: white; border: none; font-weight: bold; }
        .btn-danger { background: var(--danger); color: white; border: none; }
        .btn-success { background: var(--success); color: white; border: none; }
        .btn-outline-danger { background: transparent; color: var(--danger); border: 1px solid var(--danger); width: auto; padding: 5px 10px; }

        .navbar {
            position: fixed;
            bottom: 0;
            width: 100%;
            display: flex;
            background: white;
            border-top: 1px solid #eee;
        }

        .navbar button {
            flex: 1;
            border: none;
            background: white;
            padding: 15px;
            font-size: 14px;
            margin: 0;
            border-radius: 0;
        }

        .navbar button.active { color: var(--primary); font-weight: bold; }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .badge-lunas {
            background: #dcfce7;
            color: #166534;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="header">RADITZ OJOL PRO</div>

<div class="container">
    <div id="page1" class="page active">
        <div class="card">
            <h3>Penerimaan Order</h3>
            <p style="font-size: 0.8rem; color: #64748b;">Tarif: â‰¤2km = Rp5.000 | >2km = +Rp2.000/km</p>
            <input type="text" id="namaPelanggan" placeholder="Nama Pelanggan">
            <input type="number" id="jarak" placeholder="Jarak (km)">
            <button class="btn-primary" onclick="hitungOngkosProgresif()">Hitung Ongkos</button>
        </div>
        <div id="hasilOrder"></div>
    </div>

    <div id="page2" class="page">
        <div class="card">
            <h3>Tambah Pendapatan</h3>
            <input type="number" id="manualPendapatan" placeholder="Rp Pendapatan Lain">
            <button class="btn-primary" onclick="tambahManual()">Tambah ke Rekap</button>
        </div>

        <div class="card">
            <h3>Riwayat & Rekap</h3>
            <div id="rekapHarian">Total Hari Ini: Rp 0</div>
            <div id="rekapBulanan">Total Bulan Ini: Rp 0</div>
            <hr>
            <div id="listRiwayat" style="max-height: 200px; overflow-y: auto;"></div>
            <button class="btn-danger" style="margin-top: 15px;" onclick="resetKeuangan()">Reset Semua Data Keuangan</button>
        </div>
    </div>

    <div id="page3" class="page">
        <div class="card">
            <h3>Tambah Cicilan</h3>
            <input type="text" id="namaCicilan" placeholder="Nama Cicilan">
            <input type="number" id="jumlahCicilan" placeholder="Jumlah (Rp)">
            <button class="btn-primary" onclick="tambahCicilan()">Simpan Cicilan</button>
        </div>
        <div class="card">
            <h3>Daftar Cicilan</h3>
            <div id="listCicilan"></div>
        </div>
    </div>
</div>

<div class="navbar">
    <button onclick="showPage(1, this)" class="active">Order</button>
    <button onclick="showPage(2, this)">Keuangan</button>
    <button onclick="showPage(3, this)">Cicilan</button>
</div>

<script>
    let dataPendapatan = JSON.parse(localStorage.getItem("pendapatan")) || [];
    let dataCicilan = JSON.parse(localStorage.getItem("cicilan")) || [];

    function showPage(num, btn) {
        document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
        document.querySelectorAll(".navbar button").forEach(b => b.classList.remove("active"));
        document.getElementById("page" + num).classList.add("active");
        btn.classList.add("active");
    }

    // --- LOGIKA ORDER (TARIF PROGRESIF) ---
    function hitungOngkosProgresif() {
        let nama = document.getElementById("namaPelanggan").value;
        let jarak = parseFloat(document.getElementById("jarak").value);
        
        if (!nama || isNaN(jarak)) return alert("Lengkapi data!");

        let total = 0;
        if (jarak <= 2) {
            total = 5000;
        } else {
            total = 5000 + ((jarak - 2) * 2000);
        }

        document.getElementById("hasilOrder").innerHTML = `
            <div class="card">
                <strong>Detail Order:</strong><br>
                Pelanggan: ${nama}<br>
                Jarak: ${jarak} km<br>
                Total: <b>Rp ${total.toLocaleString()}</b>
                <button class="btn-success" onclick="simpanKeRekap('${nama}', ${total})">Selesaikan & Simpan</button>
            </div>`;
    }

    function simpanKeRekap(nama, total) {
        let tgl = new Date();
        dataPendapatan.push({
            id: Date.now(),
            tanggal: tgl.toLocaleDateString(),
            bulan: tgl.getMonth() + 1,
            nama: nama,
            total: total
        });
        localStorage.setItem("pendapatan", JSON.stringify(dataPendapatan));
        document.getElementById("hasilOrder").innerHTML = "";
        updateRekap();
        alert("Berhasil disimpan!");
    }

    // --- LOGIKA KEUANGAN ---
    function tambahManual() {
        let nominal = parseFloat(document.getElementById("manualPendapatan").value);
        if (isNaN(nominal)) return alert("Masukkan angka!");
        simpanKeRekap("Manual/Lainnya", nominal);
        document.getElementById("manualPendapatan").value = "";
    }

    function hapusRiwayat(id) {
        if(confirm("Hapus catatan ini?")) {
            dataPendapatan = dataPendapatan.filter(d => d.id !== id);
            localStorage.setItem("pendapatan", JSON.stringify(dataPendapatan));
            updateRekap();
        }
    }

    function resetKeuangan() {
        if(confirm("PERINGATAN: Hapus seluruh riwayat pendapatan?")) {
            dataPendapatan = [];
            localStorage.removeItem("pendapatan");
            updateRekap();
        }
    }

    function updateRekap() {
        let hariIni = new Date().toLocaleDateString();
        let bulanIni = new Date().getMonth() + 1;
        let totalHarian = 0, totalBulanan = 0, htmlRiwayat = "";

        dataPendapatan.forEach(d => {
            if (d.tanggal === hariIni) totalHarian += d.total;
            if (d.bulan === bulanIni) totalBulanan += d.total;
            
            htmlRiwayat += `
                <div class="history-item">
                    <small>${d.nama} (Rp ${d.total.toLocaleString()})</small>
                    <button class="btn-outline-danger" onclick="hapusRiwayat(${d.id})">Del</button>
                </div>`;
        });

        document.getElementById("rekapHarian").innerHTML = `<b>Total Hari Ini:</b> Rp ${totalHarian.toLocaleString()}`;
        document.getElementById("rekapBulanan").innerHTML = `<b>Total Bulan Ini:</b> Rp ${totalBulanan.toLocaleString()}`;
        document.getElementById("listRiwayat").innerHTML = htmlRiwayat || "<small>Belum ada riwayat.</small>";
    }

    // --- LOGIKA CICILAN ---
    function tambahCicilan() {
        let nama = document.getElementById("namaCicilan").value;
        let jumlah = parseFloat(document.getElementById("jumlahCicilan").value);

        if (!nama || isNaN(jumlah)) return alert("Lengkapi data cicilan!");
        dataCicilan.push({ id: Date.now(), nama, jumlah, lunas: false });
        localStorage.setItem("cicilan", JSON.stringify(dataCicilan));
        tampilkanCicilan();
        document.getElementById("namaCicilan").value = "";
        document.getElementById("jumlahCicilan").value = "";
    }

    function toggleLunas(id) {
        dataCicilan = dataCicilan.map(c => c.id === id ? { ...c, lunas: !c.lunas } : c);
        localStorage.setItem("cicilan", JSON.stringify(dataCicilan));
        tampilkanCicilan();
    }

    function hapusCicilan(id) {
        if(confirm("Hapus cicilan ini?")) {
            dataCicilan = dataCicilan.filter(c => c.id !== id);
            localStorage.setItem("cicilan", JSON.stringify(dataCicilan));
            tampilkanCicilan();
        }
    }

    function tampilkanCicilan() {
        let html = "";
        dataCicilan.forEach(c => {
            html += `
                <div class="history-item" style="${c.lunas ? 'opacity: 0.6' : ''}">
                    <div>
                        <span style="${c.lunas ? 'text-decoration: line-through' : ''}">${c.nama} - Rp ${c.jumlah.toLocaleString()}</span>
                        ${c.lunas ? '<span class="badge-lunas">LUNAS</span>' : ''}
                    </div>
                    <div>
                        <button onclick="toggleLunas(${c.id})" style="width:auto; padding:5px; font-size:10px">${c.lunas ? 'Batal' : 'Lunas'}</button>
                        <button class="btn-outline-danger" onclick="hapusCicilan(${c.id})">Hapus</button>
                    </div>
                </div>`;
        });
        document.getElementById("listCicilan").innerHTML = html || "<small>Tidak ada cicilan.</small>";
    }

    // Jalankan awal
    updateRekap();
    tampilkanCicilan();
</script>

</body>
</html>
